model FormTemplate {
  id                  String               @id @default(uuid())
  companyId           String
  name                String
  description         String? // description of the form
  formType            FormTemplateCategory @default(GENERAL)
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  isActive            FormTemplateStatus   @default(DRAFT)
  isSignatureRequired Boolean              @default(false)
  Submissions         FormSubmission[]
  Company             Company              @relation(fields: [companyId], references: [id])
  FormGrouping        FormGrouping[]       @relation("FormGroupingToFormTemplate")
}

model FormGrouping {
  id           String         @id @default(uuid())
  title        String?
  order        Int
  Fields       FormField[]
  FormTemplate FormTemplate[] @relation("FormGroupingToFormTemplate")
}

model FormField {
  id             String            @id @default(uuid())
  formGroupingId String
  label          String // question or field name
  type           FieldType
  assetType      AssetType? // used for search asset field type
  required       Boolean           @default(false)
  order          Int
  placeholder    String?
  minLength      Int? // used for text fields to set minimum character length
  maxLength      Int?
  multiple       Boolean?          @default(false) // used for select fields to allow multiple selections to be made
  content        String?
  filter         String? // used for filtering options in select fields
  FormGrouping   FormGrouping      @relation(fields: [formGroupingId], references: [id], onDelete: Cascade)
  Options        FormFieldOption[]
}

model FormFieldOption {
  id      String    @id @default(uuid())
  fieldId String
  value   String
  Field   FormField @relation(fields: [fieldId], references: [id], onDelete: Cascade)
}

model FormSubmission {
  id             String         @id @default(uuid())
  title          String?
  formTemplateId String
  userId         String
  formType       String?
  data           Json?
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  submittedAt    DateTime?
  status         FormStatus     @default(DRAFT)
  Approvals      FormApproval[]
  FormTemplate   FormTemplate   @relation(fields: [formTemplateId], references: [id], onDelete: Cascade)
  User           User           @relation(fields: [userId], references: [id])
}

model FormApproval {
  id               String         @id @default(uuid())
  formSubmissionId String
  signedBy         String?
  submittedAt      DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  signature        String?
  comment          String?
  FormSubmission   FormSubmission @relation(fields: [formSubmissionId], references: [id], onDelete: Cascade)
  Approver         User?          @relation(fields: [signedBy], references: [id])
}
